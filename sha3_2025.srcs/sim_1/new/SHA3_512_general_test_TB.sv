`timescale 1ns / 1ps

/*
10mess 89ABCDEF X 10: hash: 5F0DBA6DB841D6FD31CE6590671399AE6E429E57254765498C1569392796783E1B810A3783B4FD10AD4C33B97BBC6788BB801530841A599EB0F6AD02D87404D85F0DBA6DB841D6FD31CE6590671399AE6E429E57254765498C1569392796783E1B810A3783B4FD10AD4C33B97BBC6788BB801530841A599EB0F6AD02D874045F
15mess 89ABCDEF X 15: hash: E8AFFFBF4CAA19629409381A4A1792E58FEE73D9A83CC75AB1737E5FEE28F2D2B497C454D1F451D66D00782FBE93AC849D09C8D5608CDCB27A0DC0E3D6F53CCFE8AFFFBF4CAA19629409381A4A1792E58FEE73D9A83CC75AB1737E5FEE28F2D2B497C454D1F451D66D00782FBE93AC849D09C8D5608CDCB27A0DC0E3D6F53CE8
20mess 89ABCDEF X 20: hash: 1BC738E9EE423D626010A691975E6A65519697D6A6562A20382A7B0F94E06849892DD187E249940A1369049074F8E291DF480F25B202B26E3CCE65147ACA43021BC738E9EE423D626010A691975E6A65519697D6A6562A20382A7B0F94E06849892DD187E249940A1369049074F8E291DF480F25B202B26E3CCE65147ACA431B
25mess 89ABCDEF X 25: hash: ECCB954BBE179C87F001940A6B4A45E041C7C1938269CF5B331DA006E91B43F38BF8D3C85F18EA92FFFEDB3F12F41506ED498D5FBD08E99A270413BFED154DDFECCB954BBE179C87F001940A6B4A45E041C7C1938269CF5B331DA006E91B43F38BF8D3C85F18EA92FFFEDB3F12F41506ED498D5FBD08E99A270413BFED154DEC
30mess 89ABCDEF X 30: hash: 494AC39CBEC59141C6D786179B4BB005F3A416E7C67F60ACE7800496B0AC9A3B5AD4009DA84E5E19D98E15C9F4150D8922C5FBE2B04917F5E3DB7F5D7615FC91494AC39CBEC59141C6D786179B4BB005F3A416E7C67F60ACE7800496B0AC9A3B5AD4009DA84E5E19D98E15C9F4150D8922C5FBE2B04917F5E3DB7F5D7615FC49
17mess 89ABCDEF X 17: hash: 35AB472939BCDAD25371BD3DA23CA78A3741217831C7E810CC005ABAE8640A03D4C07D87997AD0D392F52D71190FDB9CA02B2DA924743540322380110597799335AB472939BCDAD25371BD3DA23CA78A3741217831C7E810CC005ABAE8640A03D4C07D87997AD0D392F52D71190FDB9CA02B2DA9247435403223801105977935
18mess 89ABCDEF X 18: hash: 9FDFCF16B8360EC0663FECCF511DC0741C27A82725E18DC721A38F2256EE6747B0FE9E22D4CA7DEC5181BC7CE69FF4B77D6D82FDE2931C4513003FC76371B3CD9FDFCF16B8360EC0663FECCF511DC0741C27A82725E18DC721A38F2256EE6747B0FE9E22D4CA7DEC5181BC7CE69FF4B77D6D82FDE2931C4513003FC76371B39F
19mess 89ABCDEF X 19: hash: 8E9C34C7509F3C4AE2BA9BF3772010AF2E5795082BDFC511642C835A64C9927571FF6F766AF1746678FFD0C68601B2AB2631F9D75BA7B53051F52FE946C985738E9C34C7509F3C4AE2BA9BF3772010AF2E5795082BDFC511642C835A64C9927571FF6F766AF1746678FFD0C68601B2AB2631F9D75BA7B53051F52FE946C9858E
*/


module SHA3_512_general_test_TB();

localparam DATA_INPUT_WIDTH = 32;
localparam MEMORY_DEPTH = 5;
localparam OUTPUT_HASH_SIZE = 512;
localparam PERMUTATION_INPUT_WORD_WIDTH = 1600 - 2 * OUTPUT_HASH_SIZE;

logic [DATA_INPUT_WIDTH-1:0] data_in_seq;
logic [OUTPUT_HASH_SIZE-1:0] hash_out;
logic clk, a_rst, ce, data_in_valid, hash_out_valid,blocked_in;

SHA3_512_IN_32W #(
    .MEMORY_DEPTH_RATIO_SIZED(MEMORY_DEPTH)
)   UUT (
    .CLK(clk),
    .A_RST(a_rst),
    .CE(ce),
    .IN_BUS(data_in_seq),
    .IN_VALID(data_in_valid),
    .BLOCKED_INPUT(blocked_in),
    .SHA3_HASH_OUTPUT(hash_out),
    .SHA3_HASH_VALID(hash_out_valid)
);

initial begin
	#0 clk = 1'b1;
	forever 
	#5 clk = ~clk;
end

initial begin
    #0 a_rst       =  1'b1;
    ce          =  1'b0;
    data_in_valid   =  1'b0;
    #50 a_rst   =  1'b0;
    #50 ce      =  1'b1; //100
    #50 data_in_valid   = 1'b1; //1mess start 150
    #100 data_in_valid  = 1'b0; //1mess end 250
    #10 data_in_valid   = 1'b1; //2mess start 260
    #150 data_in_valid  = 1'b0; //2mess end 410
    #10 data_in_valid   = 1'b1; //3mess start 420
    #200 data_in_valid  = 1'b0; //3mess end 620
    #10 data_in_valid   = 1'b1; //4mess start 630
    #250 data_in_valid  = 1'b0; //4mess end 880
    #10 data_in_valid   = 1'b1; //5mess start 890
    #300 data_in_valid  = 1'b0; //5mess end 1190
    #10 data_in_valid   = 1'b1; //6mess start 1200
    #170 data_in_valid  = 1'b0; //6mess end 1370
    #10 data_in_valid   = 1'b1; //7mess start 1380
    #180 data_in_valid  = 1'b0; //7mess end 1560
    #10 data_in_valid   = 1'b1; //8mess start 1570
    #190 data_in_valid  = 1'b0; //8mess end 1760
    #1000 $finish;
    
end

initial begin
    #0 data_in_seq      =  {4{8'hF0}};
    #140 data_in_seq    =  {32'h91D5B3F7};
    #2160 data_in_seq   =   {4{8'hF0}};
end

endmodule
